{% extends 'layout' %}

{% set pageTitle %}
Keresés{% if form.textToSearch is defined %}: {{ form.textToSearch }}{% endif %} | Szentírás
{% endset %}

{% block content %}
    <h2>Keresés a Bibliában</h2>
    <div class="panel panel-default">
        <div class="panel-body">
            <form role="form" method="post"
                  action="{{ action('SzentirasHu\\Controllers\\Search\\SearchController@postSearch') }}">
                <div class="form-group">
                    <label for="textToSearch">Keresendő</label>
                    <input type="text" name="textToSearch" id="textToSearch" value="{{ form.textToSearch }}" class="form-control"/>
                </div>
                <div class="form-group">
                    <label for="translation">Fordítás</label>
                    <select name="translation" class="form-control" id="translation">
                        <option value="0" {{ form.translation is not defined ? 'selected' }}>mind</option>
                        {% for translation in translations %}
                            <option value="{{ translation.id }}" {{ translation.id == form.translation.id ? 'selected' }}>{{ translation.name }}</option>
                        {% endfor %}
                    </select>
                </div>
                <div class="form-group">
                    <label for="book">Könyv</label>
                    <select name="book" class="form-control" id="book">
                        <option value="all" {{ 'all' == form.book ? 'selected' }}>mind</option>
                        <option value="old_testament" {{ 'old_testament' == form.book ? 'selected' }}>Ószövetség</option>
                        <option value="new_testament" {{ 'new_testament' == form.book ? 'selected' }}>Újszövetség</option>
                        {% for book in books %}
                            <option value="{{ book.id }}" {{ book.id == form.book ? 'selected' }}>{{ book.name }}</option>
                        {% endfor %}
                    </select>
                </div>
                <div class="form-group">
                    <label for="grouping">Csoportosítás</label>
                    <select name="grouping" class="form-control" id="grouping">
                        <option value="chapter" {{ form.grouping == 'chapter' ? 'selected' }}>fejezetenként</option>
                        <option value="verse" {{ form.grouping == 'verse' ? 'selected' }}>versenként</option>
                    </select>
                </div>
                <input type="submit" value="Keresés" class="btn btn-default"/>
            </form>
        </div>
    </div>

    {% if bookRef is defined %}
        <h5>Igehely</h5>
        {% for verseContainer in bookRef.verseContainers %}
            <blockquote>
                <footer>
                    <a href="{{ bookRef.link }}">{{ bookRef.label }}</a>
                </footer>
                {% include 'textDisplay.parsedVerseContainer' with { 'verseContainer' : verseContainer, 'translation' :  translation } %}
            </blockquote>
        {% endfor %}
    {% endif %}

    {% if fullTextResults is defined %}
        {% for verse in fullTextResults %}
            {{ verse.chapter }},{{verse.numv}}: {{ verse.verse }}
            <br>
        {% endfor %}
    {% endif %}

    {% if form.textToSearch is not defined %}
        {% include 'searchInfo' %}
    {% endif %}

{% endblock %}